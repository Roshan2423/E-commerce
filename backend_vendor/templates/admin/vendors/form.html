{% extends 'admin/base.html' %}
{% load static %}

{% block title %}{% if is_edit %}Edit{% else %}Add{% endif %} Business - OVN Store{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1 class="page-title">{% if is_edit %}Edit Business{% else %}Add New Business{% endif %}</h1>
        <p class="page-subtitle">{% if is_edit %}Update business details{% else %}Register a new vendor business{% endif %}</p>
    </div>
    <div class="header-actions">
        <a href="{% url 'vendor_admin:list' %}" class="btn btn-outline">
            <i class="fas fa-arrow-left"></i>
            <span>Back to List</span>
        </a>
    </div>
</div>

{% if not is_edit %}
<div class="info-banner">
    <i class="fas fa-info-circle"></i>
    <div>
        <strong>How it works:</strong>
        <p>When you add a business email here, the next time a user logs in with that email (via Google or regular login), they will automatically be linked to this business and redirected to their vendor dashboard.</p>
    </div>
</div>
{% endif %}

<form method="post" class="business-form">
    {% csrf_token %}

    <div class="form-card">
        <div class="form-section">
            <h3 class="section-title">Business Information</h3>

            <div class="form-row">
                <div class="form-group">
                    <label for="id_email">Business Email *</label>
                    <input type="email" id="id_email" name="email" value="{{ form.email.value|default:'' }}" required placeholder="business@example.com">
                    {% if form.email.errors %}
                    <span class="error-text">{{ form.email.errors.0 }}</span>
                    {% endif %}
                    <small>This email will be used to link the vendor account</small>
                </div>
                <div class="form-group">
                    <label for="id_business_name">Business Name *</label>
                    <input type="text" id="id_business_name" name="business_name" value="{{ form.business_name.value|default:'' }}" required placeholder="My Amazing Store">
                    {% if form.business_name.errors %}
                    <span class="error-text">{{ form.business_name.errors.0 }}</span>
                    {% endif %}
                </div>
            </div>

            <div class="form-group">
                <label for="id_description">Description</label>
                <textarea id="id_description" name="description" rows="3" placeholder="Brief description of the business...">{{ form.description.value|default:'' }}</textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="id_phone">Phone Number</label>
                    <input type="text" id="id_phone" name="phone" value="{{ form.phone.value|default:'' }}" placeholder="+977-XXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label for="id_commission_rate">Commission Rate (%)</label>
                    <input type="number" id="id_commission_rate" name="commission_rate" value="{{ form.commission_rate.value|default:'10' }}" min="0" max="100" step="0.01">
                </div>
            </div>

            <div class="form-group">
                <label for="id_address">Address</label>
                <textarea id="id_address" name="address" rows="2" placeholder="Business address...">{{ form.address.value|default:'' }}</textarea>
            </div>

            <div class="form-group">
                <label for="id_status">Status</label>
                <select id="id_status" name="status">
                    <option value="approved" {% if form.status.value == 'approved' %}selected{% endif %}>Approved (Ready to use)</option>
                    <option value="pending" {% if form.status.value == 'pending' %}selected{% endif %}>Pending (Needs approval)</option>
                    <option value="suspended" {% if form.status.value == 'suspended' %}selected{% endif %}>Suspended</option>
                    <option value="rejected" {% if form.status.value == 'rejected' %}selected{% endif %}>Rejected</option>
                </select>
            </div>
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary btn-lg">
            <i class="fas fa-{% if is_edit %}save{% else %}plus{% endif %}"></i>
            <span>{% if is_edit %}Update Business{% else %}Add Business{% endif %}</span>
        </button>
    </div>
</form>

<style>
    .info-banner {
        display: flex;
        gap: 1rem;
        padding: 1.25rem 1.5rem;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
        border: 1px solid rgba(99, 102, 241, 0.3);
        border-radius: 12px;
        margin-bottom: 2rem;
    }

    .info-banner i {
        font-size: 1.5rem;
        color: var(--primary);
    }

    .info-banner strong {
        display: block;
        margin-bottom: 0.25rem;
        color: var(--text);
    }

    .info-banner p {
        margin: 0;
        color: var(--text-secondary);
        font-size: 0.875rem;
    }

    .form-card {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 16px;
        overflow: hidden;
    }

    .form-section {
        padding: 1.5rem;
    }

    .section-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text);
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--border);
    }

    .form-row {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--text);
        margin-bottom: 0.5rem;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: var(--bg);
        color: var(--text);
        font-size: 0.875rem;
    }

    .form-group small {
        display: block;
        margin-top: 0.25rem;
        color: var(--text-secondary);
        font-size: 0.75rem;
    }

    .error-text {
        display: block;
        margin-top: 0.25rem;
        color: #ef4444;
        font-size: 0.75rem;
    }

    .form-actions {
        margin-top: 2rem;
        display: flex;
        justify-content: flex-end;
    }

    .btn-lg {
        padding: 1rem 2rem;
        font-size: 1rem;
    }
</style>
{% endblock %}
