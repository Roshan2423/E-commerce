{% extends 'demo/pro/admin/base.html' %}

{% block title %}Analytics{% endblock %}

{% block breadcrumb %}Analytics{% endblock %}

{% block extra_css %}
<style>
    .chart-placeholder {
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        height: 250px;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: var(--text-secondary);
    }
    .chart-placeholder i { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }
    .chart-placeholder span { font-size: 13px; }
    .metric-change {
        font-size: 12px;
        margin-top: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
    }
    .metric-change.up { color: var(--success); }
    .metric-change.down { color: var(--danger); }
    .category-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 0;
        border-bottom: 1px solid var(--border);
    }
    .category-item:last-child { border-bottom: none; }
    .category-color { width: 12px; height: 12px; border-radius: 3px; }
    .category-name { flex: 1; font-size: 13px; color: var(--text-primary); }
    .category-value { font-size: 13px; font-weight: 600; color: var(--text-primary); }
    .top-product-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 0;
        border-bottom: 1px solid var(--border);
    }
    .top-product-item:last-child { border-bottom: none; }
    .rank {
        width: 28px;
        height: 28px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 600;
    }
    .rank.gold { background: #fef3c7; color: #d97706; }
    .rank.silver { background: #f1f5f9; color: var(--text-secondary); }
    .rank.bronze { background: #fed7aa; color: #c2410c; }
    .rank.default { background: #f1f5f9; color: var(--text-secondary); }
    .page-actions {
        display: flex;
        gap: 0.75rem;
        align-items: center;
    }
    .select-control {
        padding: 0.5rem 0.75rem;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.875rem;
        background: white;
        cursor: not-allowed;
    }
    .view-all {
        font-size: 0.8125rem;
        color: var(--primary);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }
    .view-all:hover {
        text-decoration: underline;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <h1 class="page-title">Analytics</h1>
        <p class="page-subtitle">Track your store performance</p>
    </div>
    <div class="page-actions">
        <select class="select-control" style="width: 140px;" disabled>
            <option>Last 7 Days</option>
            <option>Last 30 Days</option>
            <option>Last 3 Months</option>
        </select>
        <button class="btn btn-outline demo-disabled">
            <i class="fas fa-download"></i> Export
        </button>
    </div>
</div>

<!-- Key Metrics -->
<div class="stats-grid">
    <div class="stat-card" style="text-align: center;">
        <div class="stat-icon primary" style="margin: 0 auto 1rem;">
            <i class="fas fa-dollar-sign"></i>
        </div>
        <div class="stat-content" style="text-align: center;">
            <div class="stat-value">Rs. {{ total_revenue|floatformat:0|default:"125,000" }}</div>
            <div class="stat-label">Total Revenue</div>
            <div class="metric-change up"><i class="fas fa-arrow-up"></i> 12.5% vs last period</div>
        </div>
    </div>
    <div class="stat-card" style="text-align: center;">
        <div class="stat-icon success" style="margin: 0 auto 1rem;">
            <i class="fas fa-shopping-bag"></i>
        </div>
        <div class="stat-content" style="text-align: center;">
            <div class="stat-value">{{ total_orders|default:"48" }}</div>
            <div class="stat-label">Total Orders</div>
            <div class="metric-change up"><i class="fas fa-arrow-up"></i> 8.2% vs last period</div>
        </div>
    </div>
    <div class="stat-card" style="text-align: center;">
        <div class="stat-icon warning" style="margin: 0 auto 1rem;">
            <i class="fas fa-receipt"></i>
        </div>
        <div class="stat-content" style="text-align: center;">
            <div class="stat-value">Rs. 2,604</div>
            <div class="stat-label">Avg. Order Value</div>
            <div class="metric-change up"><i class="fas fa-arrow-up"></i> 3.1% vs last period</div>
        </div>
    </div>
    <div class="stat-card" style="text-align: center;">
        <div class="stat-icon info" style="margin: 0 auto 1rem;">
            <i class="fas fa-percentage"></i>
        </div>
        <div class="stat-content" style="text-align: center;">
            <div class="stat-value">3.2%</div>
            <div class="stat-label">Conversion Rate</div>
            <div class="metric-change down"><i class="fas fa-arrow-down"></i> 0.5% vs last period</div>
        </div>
    </div>
</div>

<div class="content-grid" style="margin-bottom: 1.5rem;">
    <!-- Sales Chart -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-chart-line"></i> Sales Overview</h3>
            <select class="select-control" style="width: 120px;" disabled>
                <option>Revenue</option>
                <option>Orders</option>
            </select>
        </div>
        <div class="card-body">
            <div class="chart-placeholder">
                <i class="fas fa-chart-line"></i>
                <span>Sales trend visualization</span>
            </div>
        </div>
    </div>

    <!-- Category Distribution -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-chart-pie"></i> Sales by Category</h3>
        </div>
        <div class="card-body">
            <div class="chart-placeholder" style="height: 150px;">
                <i class="fas fa-chart-pie"></i>
                <span>Category distribution</span>
            </div>
            <div style="margin-top: 16px;">
                {% for category in categories %}
                <div class="category-item">
                    <div class="category-color" style="background: {% cycle '#7c3aed' '#ec4899' '#3b82f6' '#10b981' '#f59e0b' %};"></div>
                    <span class="category-name">{{ category.name }}</span>
                    <span class="category-value">{{ category.product_count }} products</span>
                </div>
                {% empty %}
                <div class="category-item">
                    <div class="category-color" style="background: #7c3aed;"></div>
                    <span class="category-name">Electronics</span>
                    <span class="category-value">35%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #ec4899;"></div>
                    <span class="category-name">Fashion</span>
                    <span class="category-value">28%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #3b82f6;"></div>
                    <span class="category-name">Home & Living</span>
                    <span class="category-value">22%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #10b981;"></div>
                    <span class="category-name">Sports</span>
                    <span class="category-value">15%</span>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<div class="content-grid">
    <!-- Top Products -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-trophy"></i> Top Selling Products</h3>
            <a href="{% url 'demo:pro_admin_products' %}" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
        </div>
        <div class="card-body">
            {% for product in top_products|slice:":5" %}
            <div class="top-product-item">
                <div class="rank {% if forloop.counter == 1 %}gold{% elif forloop.counter == 2 %}silver{% elif forloop.counter == 3 %}bronze{% else %}default{% endif %}">{{ forloop.counter }}</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500; font-size: 13px;">{{ product.name|truncatewords:5 }}</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">{{ product.category.name|default:"General" }}</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 600; font-size: 13px;">Rs. {{ product.price|floatformat:0 }}</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">{{ forloop.counter|add:10 }} sold</div>
                </div>
            </div>
            {% empty %}
            <div class="top-product-item">
                <div class="rank gold">1</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500; font-size: 13px;">Premium Wireless Headphones</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">Electronics</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 600; font-size: 13px;">Rs. 45,000</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">18 sold</div>
                </div>
            </div>
            <div class="top-product-item">
                <div class="rank silver">2</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500; font-size: 13px;">Cotton Summer Dress</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">Fashion</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 600; font-size: 13px;">Rs. 32,000</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">14 sold</div>
                </div>
            </div>
            <div class="top-product-item">
                <div class="rank bronze">3</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500; font-size: 13px;">Smart Watch Pro</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">Electronics</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 600; font-size: 13px;">Rs. 28,500</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">12 sold</div>
                </div>
            </div>
            <div class="top-product-item">
                <div class="rank default">4</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500; font-size: 13px;">Leather Wallet</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">Fashion</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 600; font-size: 13px;">Rs. 18,900</div>
                    <div style="color: var(--text-secondary); font-size: 12px;">9 sold</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Traffic Sources -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-globe"></i> Traffic Sources</h3>
        </div>
        <div class="card-body">
            <div class="chart-placeholder" style="height: 150px;">
                <i class="fas fa-chart-bar"></i>
                <span>Traffic distribution</span>
            </div>
            <div style="margin-top: 16px;">
                <div class="category-item">
                    <div class="category-color" style="background: #3b82f6;"></div>
                    <span class="category-name">Direct</span>
                    <span class="category-value">42%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #10b981;"></div>
                    <span class="category-name">Organic Search</span>
                    <span class="category-value">28%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #ec4899;"></div>
                    <span class="category-name">Social Media</span>
                    <span class="category-value">18%</span>
                </div>
                <div class="category-item">
                    <div class="category-color" style="background: #f59e0b;"></div>
                    <span class="category-name">Referral</span>
                    <span class="category-value">12%</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
